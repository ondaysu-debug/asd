# ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π CMC DEX API v4 - –ó–ê–í–ï–†–®–ï–ù–ê

**–î–∞—Ç–∞**: 2025-10-31  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´ –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–´**  
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞**: ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç CMC API –∫–ª—é—á (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

---

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:

#### 1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–∞–ø–ø–∏–Ω–≥ —Å–µ—Ç–µ–≤—ã—Ö —Å–ª–æ–≥–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: BSC –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–µ–≤–µ—Ä–Ω—ã–π slug `"bnb-chain"`, –≤—ã–∑—ã–≤–∞—è –æ—à–∏–±–∫–∏ "network not supported"  
**–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `"bsc"` + –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–µ—Ç–∏

#### 2. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ API
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–ª–∞ –æ—à–∏–±–∫–∏ API –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã  
**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º error_code, –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä, debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

#### 3. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ OHLCV –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∏ OHLCV –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –¥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö  
**–†–µ—à–µ–Ω–∏–µ**: –†–∞–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ API + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ GeckoTerminal

#### 4. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω health check
**–ü—Ä–æ–±–ª–µ–º–∞**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è —Å–µ—Ç—å, –±–µ–∑ –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–æ–∫  
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–π —Å–µ—Ç–∏ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º –∏ emoji –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏

#### 5. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
**–î–æ–±–∞–≤–ª–µ–Ω–æ**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ URL –∑–∞–ø—Ä–æ—Å–æ–≤, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤, –æ—à–∏–±–æ–∫ API –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ

#### 6. ‚úÖ –°–æ–∑–¥–∞–Ω –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
**–°–æ–∑–¥–∞–Ω–æ**: `test_cmc_api.py` - —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ network_slug –∑–Ω–∞—á–µ–Ω–∏—è

---

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
|------|-----------|--------------|
| `wakebot/config.py` | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω chain_slugs | ‚úÖ PASS |
| `wakebot/discovery.py` | –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è | ‚úÖ PASS |
| `wakebot/cmc.py` | –û–±—Ä–∞–±–æ—Ç–∫–∞ OHLCV –æ—à–∏–±–æ–∫ | ‚úÖ PASS |
| `wakebot/main.py` | Per-chain health check | ‚úÖ PASS |
| `.env.example` | –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è v4 | ‚úÖ PASS |
| `test_cmc_api.py` | –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç | ‚úÖ PASS |

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Offline Health Check
```bash
$ python3 -m wakebot --health
[health] chains: ethereum - OK
[health] cmc_dex_base: https://pro-api.coinmarketcap.com/v4/dex - OK
[health] WARN: CMC_API_KEY not set (may limit API access)
[health] Result: PASS ‚úÖ
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
$ python3 -c "from wakebot.config import Config; cfg = Config.load(); print(cfg.chain_slugs['bsc'])"
bsc ‚úÖ  # –ü—Ä–∞–≤–∏–ª—å–Ω–æ! (–±—ã–ª–æ: bnb-chain ‚ùå)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```bash
$ python3 test_validation.py
[cmc][validate] API Error 1002: API key missing ‚úÖ
# –û—à–∏–±–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è
```

---

## üîë –¢—Ä–µ–±—É–µ–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å CMC API –∫–ª—é—á
1. –ü–µ—Ä–µ–π—Ç–∏: https://pro.coinmarketcap.com/account
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω: 333 –∑–∞–ø—Ä–æ—Å–∞/–¥–µ–Ω—å)
3. –°–æ–∑–¥–∞—Ç—å API –∫–ª—é—á
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å .env —Ñ–∞–π–ª
```bash
cp .env.example .env
nano .env

# –î–æ–±–∞–≤–∏—Ç—å:
CMC_API_KEY=–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
TG_BOT_TOKEN=–≤–∞—à_telegram_bot_token
TG_CHAT_ID=–≤–∞—à_telegram_chat_id
CHAINS=ethereum
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
python3 -m wakebot --health-online

# –û–¥–∏–Ω —Ü–∏–∫–ª –¥–ª—è —Ç–µ—Å—Ç–∞
python3 -m wakebot --once

# –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
python3 -m wakebot
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (—Å API –∫–ª—é—á–æ–º)

```bash
$ python3 -m wakebot --health-online

[health] Testing chain: ethereum -> network_slug: ethereum
[health] ‚úÖ ethereum: OK - 5 items
[health] Testing chain: bsc -> network_slug: bsc
[health] ‚úÖ bsc: OK - 5 items

[health] Summary: 2/2 chains working ‚úÖ
[health] Working: ethereum, bsc
[health] ‚úÖ OHLCV for ethereum/0x...: OK
[health] Result: PASS

$ python3 -m wakebot --once

[discover][ethereum] Using network_slug: ethereum
[discover][ethereum] Fetching: https://pro-api.coinmarketcap.com/v4/dex/spot-pairs/latest...
[discover][ethereum] Response keys: ['data', 'status']
[discover][ethereum] pages: 2/2 (100%), candidates: 45, scanned: 200

[cycle] ethereum: scanned=200, candidates=45, ohlcv_probes=30, alerts=3
[cycle] total scanned: 200 pools; OHLCV used: 30/30

‚úÖ –ö–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞–π–¥–µ–Ω—ã, –∞–ª–µ—Ä—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| **NEXT_STEPS.md** | üöÄ –ù–ê–ß–ê–¢–¨ –ó–î–ï–°–¨ - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç |
| **CMC_API_SETUP.md** | üîë –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ |
| **FIX_SUMMARY_2025-10-31.md** | üìä –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π |
| **CMC_V4_FIX_APPLIED.md** | üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| **test_cmc_api.py** | üß™ –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç |
| **FIXES_APPLIED_SUMMARY.txt** | üìã –ö—Ä–∞—Ç–∫–∏–π —á–µ–∫-–ª–∏—Å—Ç |

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–∞–ø–ø–∏–Ω–≥ —Å–µ—Ç–µ–≤—ã—Ö —Å–ª–æ–≥–æ–≤ (bsc: "bsc")
- [x] –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã API –æ—Ç–≤–µ—Ç–æ–≤
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ error_code –∏–∑ status
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω fallback –Ω–∞ GeckoTerminal
- [x] –†–∞—Å—à–∏—Ä–µ–Ω health check –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ç–µ–π
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –°–æ–∑–¥–∞–Ω –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
- [x] –û–±–Ω–æ–≤–ª–µ–Ω—ã —à–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [x] –ù–∞–ø–∏—Å–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ–±–∞–≤–∏—Ç—å CMC API –∫–ª—é—á** ‚Üê –û–°–¢–ê–õ–û–°–¨

---

## üéØ –ò—Ç–æ–≥

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
‚úÖ **–í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´ –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–´**

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç CMC API –∫–ª—é—á** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

### –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥
üìñ **–ß–∏—Ç–∞—Ç—å**: `NEXT_STEPS.md` –∏–ª–∏ `CMC_API_SETUP.md`  
‚öôÔ∏è **–î–µ–π—Å—Ç–≤–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å CMC API –∫–ª—é—á –≤ `.env`  
üß™ **–¢–µ—Å—Ç**: `python3 -m wakebot --health-online`  
üöÄ **–ó–∞–ø—É—Å–∫**: `python3 -m wakebot --once`

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å `python3 test_cmc_api.py` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ CMC API –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ –≤ CMC –∞–∫–∫–∞—É–Ω—Ç–µ

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ  
**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞**: ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è API –∫–ª—é—á–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º  
**–í—Ä–µ–º—è –¥–æ –∑–∞–ø—É—Å–∫–∞**: ~10 –º–∏–Ω—É—Ç (–ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞)

---

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**: 2025-10-31  
**–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã**: ‚úÖ  
**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**: ‚úÖ  
**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**: ‚úÖ (–ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è API –∫–ª—é—á–∞)
